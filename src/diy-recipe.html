<link rel="import" href="/bower_components/polymer/polymer-element.html">
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="/bower_components/iron-icon/iron-icon.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">
<link rel="import" href="/bower_components/iron-icons/image-icons.html">
<link rel="import" href="/bower_components/paper-button/paper-button.html">

<link rel="import" href="/src/functional/diy-user-cache.html">
<link rel="import" href="/src/mixins/mixin-redux.html">
<link rel="import" href="/src/mixins/mixin-static-data.html">
<link rel="import" href="/src/theme/diy-theme.html">
<link rel="import" href="/src/diy-vendor-popup.html">

<dom-module id="diy-recipe">
  <link rel="import" type="css" href="diy-recipe.css">
  <template>
    <style include="iron-flex iron-flex-alignment"></style>
    <style include="diy-theme"></style>

    <diy-user-cache uid="[[recipeUserId]]" name="{{recipeAuthor}}">
    </diy-user-cache>

    <div id="header" class="layout horizontal center">
      <h2 class="flex">[[recipeName]]</h2>
      <div id="details">
        <span class="detail">by [[recipeAuthor]]</span>
        <span class="detail">created [[recipeCreated]]</span>
      </div>

      <div id="actions" class="layout horizontal">
        <paper-button raised on-tap="onMixTap_">
          <iron-icon icon="image:colorize"></iron-icon>
        </paper-button>
        <paper-button
            raised
            hidden="[[!isAuthenticated_(authUserId, recipeUserId)]]"
            on-tap="onEditTap_">
          <iron-icon icon="icons:create"></iron-icon>
        </paper-button>
        <paper-button
            raised
            hidden="[[!isAuthenticated_(authUserId, recipeUserId)]]"
            on-tap="onDeleteTap_">
          <iron-icon icon="icons:delete"></iron-icon>
        </paper-button>
      </div>
    </div>

    <div id="ingredients" class="layout vertical">
      <div hidden$="[[hasIngredients]]">
        No ingredients here. That's odd!
      </div>
      <table>
        <template is="dom-repeat" items="[[ingredients]]">
          <tr>
            <td class="percent">[[item.percent]]%</td>
            <td class="vendor">
              <div on-tap="onVendorTap_">
                [<span>[[vendorFromKey_(item.vendor)]]</span>]
              </div>
            </td>
            <td class="flavor">[[item.flavor]]</td>
          </tr>
        </template>
      </table>
    </div>

    <div id="notes" hidden$="[[!hasRecipeNotes]]">
      <div><b>Notes:</b> [[recipeNotes]]</div>
    </div>

    <diy-vendor-popup id="vendorPopup"></diy-vendor-popup>

  </template>
  <script type="text/javascript" src="diy-recipe.js"></script>
</dom-module>
